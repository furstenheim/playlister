var app=function(){"use strict";function e(){}function t(e){return e()}function r(){return Object.create(null)}function n(e){e.forEach(t)}function s(e){return"function"==typeof e}function a(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}let o,i;function c(e,t){return e===t||(o||(o=document.createElement("a")),o.href=t,e===o.href)}function u(e,t){e.appendChild(t)}function l(e,t,r){e.insertBefore(t,r||null)}function h(e){e.parentNode&&e.parentNode.removeChild(e)}function p(e){return document.createElement(e)}function f(e){return document.createTextNode(e)}function d(){return f(" ")}function g(){return f("")}function y(e,t,r,n){return e.addEventListener(t,r,n),()=>e.removeEventListener(t,r,n)}function m(e,t,r){null==r?e.removeAttribute(t):e.getAttribute(t)!==r&&e.setAttribute(t,r)}function w(e,t){t=""+t,e.data!==t&&(e.data=t)}function v(e,t){e.value=null==t?"":t}function b(e,t,r,n){null==r?e.style.removeProperty(t):e.style.setProperty(t,r,n?"important":"")}function k(e){i=e}const _=[],$=[];let x=[];const R=[],S=Promise.resolve();let T=!1;function j(e){x.push(e)}const q=new Set;let C=0;function A(){if(0!==C)return;const e=i;do{try{for(;C<_.length;){const e=_[C];C++,k(e),O(e.$$)}}catch(e){throw _.length=0,C=0,e}for(k(null),_.length=0,C=0;$.length;)$.pop()();for(let e=0;e<x.length;e+=1){const t=x[e];q.has(t)||(q.add(t),t())}x.length=0}while(_.length);for(;R.length;)R.pop()();T=!1,q.clear(),k(e)}function O(e){if(null!==e.fragment){e.update(),n(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(j)}}const F=new Set;let z;function P(){z={r:0,c:[],p:z}}function I(){z.r||n(z.c),z=z.p}function E(e,t){e&&e.i&&(F.delete(e),e.i(t))}function U(e,t,r,n){if(e&&e.o){if(F.has(e))return;F.add(e),z.c.push((()=>{F.delete(e),n&&(r&&e.d(1),n())})),e.o(t)}else n&&n()}function N(e){return void 0!==e?.length?e:Array.from(e)}function L(e,t){e.d(1),t.delete(e.key)}function M(e,t){U(e,1,1,(()=>{t.delete(e.key)}))}function B(e,t,r,s,a,o,i,c,u,l,h,p){let f=e.length,d=o.length,g=f;const y={};for(;g--;)y[e[g].key]=g;const m=[],w=new Map,v=new Map,b=[];for(g=d;g--;){const e=p(a,o,g),n=r(e);let c=i.get(n);c?s&&b.push((()=>c.p(e,t))):(c=l(n,e),c.c()),w.set(n,m[g]=c),n in y&&v.set(n,Math.abs(g-y[n]))}const k=new Set,_=new Set;function $(e){E(e,1),e.m(c,h),i.set(e.key,e),h=e.first,d--}for(;f&&d;){const t=m[d-1],r=e[f-1],n=t.key,s=r.key;t===r?(h=t.first,f--,d--):w.has(s)?!i.has(n)||k.has(n)?$(t):_.has(s)?f--:v.get(n)>v.get(s)?(_.add(n),$(t)):(k.add(s),f--):(u(r,i),f--)}for(;f--;){const t=e[f];w.has(t.key)||u(t,i)}for(;d;)$(m[d-1]);return n(b),m}function D(e){e&&e.c()}function W(e,r,a){const{fragment:o,after_update:i}=e.$$;o&&o.m(r,a),j((()=>{const r=e.$$.on_mount.map(t).filter(s);e.$$.on_destroy?e.$$.on_destroy.push(...r):n(r),e.$$.on_mount=[]})),i.forEach(j)}function K(e,t){const r=e.$$;null!==r.fragment&&(!function(e){const t=[],r=[];x.forEach((n=>-1===e.indexOf(n)?t.push(n):r.push(n))),r.forEach((e=>e())),x=t}(r.after_update),n(r.on_destroy),r.fragment&&r.fragment.d(t),r.on_destroy=r.fragment=null,r.ctx=[])}function V(e,t){-1===e.$$.dirty[0]&&(_.push(e),T||(T=!0,S.then(A)),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function J(t,s,a,o,c,u,l,p=[-1]){const f=i;k(t);const d=t.$$={fragment:null,ctx:[],props:u,update:e,not_equal:c,bound:r(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(s.context||(f?f.$$.context:[])),callbacks:r(),dirty:p,skip_bound:!1,root:s.target||f.$$.root};l&&l(d.root);let g=!1;if(d.ctx=a?a(t,s.props||{},((e,r,...n)=>{const s=n.length?n[0]:r;return d.ctx&&c(d.ctx[e],d.ctx[e]=s)&&(!d.skip_bound&&d.bound[e]&&d.bound[e](s),g&&V(t,e)),r})):[],d.update(),g=!0,n(d.before_update),d.fragment=!!o&&o(d.ctx),s.target){if(s.hydrate){const e=function(e){return Array.from(e.childNodes)}(s.target);d.fragment&&d.fragment.l(e),e.forEach(h)}else d.fragment&&d.fragment.c();s.intro&&E(t.$$.fragment),W(t,s.target,s.anchor),A()}k(f)}class H{$$=void 0;$$set=void 0;$destroy(){K(this,1),this.$destroy=e}$on(t,r){if(!s(r))return e;const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(r),()=>{const e=n.indexOf(r);-1!==e&&n.splice(e,1)}}$set(e){var t;this.$$set&&(t=e,0!==Object.keys(t).length)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}"undefined"!=typeof window&&(window.__svelte||(window.__svelte={v:new Set})).v.add("4");class G{api;constructor(e){this.api=e}async getRequest(e){return await this.api.makeRequest("GET",e)}async postRequest(e,t,r=void 0){return await this.api.makeRequest("POST",e,t,r)}async putRequest(e,t,r=void 0){return await this.api.makeRequest("PUT",e,t,r)}async deleteRequest(e,t){return await this.api.makeRequest("DELETE",e,t)}paramsFor(e){const t=new URLSearchParams;for(let r of Object.getOwnPropertyNames(e))(e[r]||!e[r]&&"boolean"==typeof e[r])&&t.append(r,e[r].toString());return[...t].length>0?`?${t.toString()}`:""}}class Q extends G{async get(e,t){if("string"==typeof e){const r=this.paramsFor({market:t});return await this.getRequest(`albums/${e}${r}`)}const r=this.paramsFor({ids:e,market:t});return(await this.getRequest(`albums${r}`)).albums}tracks(e,t,r,n){const s=this.paramsFor({market:t,limit:r,offset:n});return this.getRequest(`albums/${e}/tracks${s}`)}}class Y extends G{async get(e){if("string"==typeof e){return this.getRequest(`artists/${e}`)}const t=this.paramsFor({ids:e});return(await this.getRequest(`artists${t}`)).artists}albums(e,t,r,n,s){const a=this.paramsFor({include_groups:t,market:r,limit:n,offset:s});return this.getRequest(`artists/${e}/albums${a}`)}topTracks(e,t){const r=this.paramsFor({market:t});return this.getRequest(`artists/${e}/top-tracks${r}`)}relatedArtists(e){return this.getRequest(`artists/${e}/related-artists`)}}class X extends G{async get(e,t){if("string"==typeof e){const r=this.paramsFor({market:t});return this.getRequest(`audiobooks/${e}${r}`)}const r=this.paramsFor({ids:e,market:t});return(await this.getRequest(`audiobooks${r}`)).audiobooks}getAudiobookChapters(e,t,r,n){const s=this.paramsFor({market:t,limit:r,offset:n});return this.getRequest(`audiobooks/${e}/chapters${s}`)}}class Z extends G{getCategories(e,t,r,n){const s=this.paramsFor({country:e,locale:t,limit:r,offset:n});return this.getRequest(`browse/categories${s}`)}getCategory(e,t,r){const n=this.paramsFor({country:t,locale:r});return this.getRequest(`browse/categories/${e}${n}`)}getNewReleases(e,t,r){const n=this.paramsFor({country:e,limit:t,offset:r});return this.getRequest(`browse/new-releases${n}`)}getFeaturedPlaylists(e,t,r,n,s){const a=this.paramsFor({country:e,locale:t,timestamp:r,limit:n,offset:s});return this.getRequest(`browse/featured-playlists${a}`)}getPlaylistsForCategory(e,t,r,n){const s=this.paramsFor({country:t,limit:r,offset:n});return this.getRequest(`browse/categories/${e}/playlists${s}`)}}class ee extends G{async get(e,t){if("string"==typeof e){const r=this.paramsFor({market:t});return this.getRequest(`chapters/${e}${r}`)}const r=this.paramsFor({ids:e,market:t});return(await this.getRequest(`chapters${r}`)).chapters}}class te extends G{async get(e,t){if("string"==typeof e){const r=this.paramsFor({market:t});return this.getRequest(`episodes/${e}${r}`)}const r=this.paramsFor({ids:e,market:t});return(await this.getRequest(`episodes${r}`)).episodes}}class re extends G{get(e){const t=this.paramsFor(e);return this.getRequest(`recommendations${t}`)}genreSeeds(){return this.getRequest("recommendations/available-genre-seeds")}}class ne extends G{getAvailableMarkets(){return this.getRequest("markets")}}class se extends G{getPlaybackState(e,t){const r=this.paramsFor({market:e,additionalTypes:t});return this.getRequest(`me/player${r}`)}getAvailableDevices(){return this.getRequest("me/player/devices")}getCurrentlyPlayingTrack(e,t){const r=this.paramsFor({market:e,additionalTypes:t});return this.getRequest(`me/player/currently-playing${r}`)}getRecentlyPlayedTracks(e,t){const r={limit:e};t&&("before"===t.type?r.before=t.timestamp:"after"===t.type&&(r.after=t.timestamp));const n=this.paramsFor(r);return this.getRequest(`me/player/recently-played${n}`)}getUsersQueue(){return this.getRequest("me/player/queue")}async transferPlayback(e,t){if(e.length>1)throw new Error("Although an array is accepted, only a single device_id is currently supported. Supplying more than one will return 400 Bad Request");await this.putRequest("me/player",{device_ids:e,play:t})}async startResumePlayback(e,t,r,n,s){const a=this.paramsFor({device_id:e});await this.putRequest(`me/player/play${a}`,{context_uri:t,uris:r,offset:n,positionMs:s})}async pausePlayback(e){const t=this.paramsFor({device_id:e});await this.putRequest(`me/player/pause${t}`)}async skipToNext(e){const t=this.paramsFor({device_id:e});await this.postRequest(`me/player/next${t}`)}async skipToPrevious(e){const t=this.paramsFor({device_id:e});await this.postRequest(`me/player/previous${t}`)}async seekToPosition(e,t){const r=this.paramsFor({position_ms:e,device_id:t});await this.putRequest(`me/player/seek${r}`)}async setRepeatMode(e,t){const r=this.paramsFor({state:e,device_id:t});await this.putRequest(`me/player/repeat${r}`)}async setPlaybackVolume(e,t){const r=this.paramsFor({volume_percent:e,device_id:t});await this.putRequest(`me/player/volume${r}`)}async togglePlaybackShuffle(e,t){const r=this.paramsFor({state:e,device_id:t});await this.putRequest(`me/player/shuffle${r}`)}async addItemToPlaybackQueue(e,t){const r=this.paramsFor({uri:e,device_id:t});await this.postRequest(`me/player/queue${r}`)}}class ae extends G{getPlaylist(e,t,r,n){const s=this.paramsFor({market:t,fields:r,additional_types:n});return this.getRequest(`playlists/${e}${s}`)}getPlaylistItems(e,t,r,n,s,a){const o=this.paramsFor({market:t,fields:r,limit:n,offset:s,additional_types:a});return this.getRequest(`playlists/${e}/tracks${o}`)}async changePlaylistDetails(e,t){await this.putRequest(`playlists/${e}`,t)}movePlaylistItems(e,t,r,n){return this.updatePlaylistItems(e,{range_start:t,range_length:r,insert_before:n})}updatePlaylistItems(e,t){return this.putRequest(`playlists/${e}/tracks`,t)}async addItemsToPlaylist(e,t,r){await this.postRequest(`playlists/${e}/tracks`,{position:r,uris:t})}async removeItemsFromPlaylist(e,t){await this.deleteRequest(`playlists/${e}/tracks`,t)}getUsersPlaylists(e,t,r){const n=this.paramsFor({limit:t,offset:r});return this.getRequest(`users/${e}/playlists${n}`)}createPlaylist(e,t){return this.postRequest(`users/${e}/playlists`,t)}getPlaylistCoverImage(e){return this.getRequest(`playlists/${e}/images`)}async addCustomPlaylistCoverImage(e,t){let r="";if(t instanceof Buffer)r=t.toString("base64");else if(t instanceof HTMLCanvasElement)r=t.toDataURL("image/jpeg").split(";base64,")[1];else if(t instanceof HTMLImageElement){const e=document.createElement("canvas");e.width=t.width,e.height=t.height;const n=e.getContext("2d");if(!n)throw new Error("Could not get canvas context");n.drawImage(t,0,0),r=e.toDataURL("image/jpeg").split(";base64,")[1]}else{if("string"!=typeof t)throw new Error("ImageData must be a Buffer, HTMLImageElement, HTMLCanvasElement, or string containing a base64 encoded jpeg");r=t}await this.addCustomPlaylistCoverImageFromBase64String(e,r)}async addCustomPlaylistCoverImageFromBase64String(e,t){await this.putRequest(`playlists/${e}/images`,t,"image/jpeg")}}class oe extends G{async execute(e,t,r,n,s,a){const o=this.paramsFor({q:e,type:t,market:r,limit:n,offset:s,include_external:a});return await this.getRequest(`search${o}`)}}class ie extends G{async get(e,t){if("string"==typeof e){const r=this.paramsFor({market:t});return this.getRequest(`shows/${e}${r}`)}const r=this.paramsFor({ids:e,market:t});return(await this.getRequest(`shows${r}`)).shows}episodes(e,t,r,n){const s=this.paramsFor({market:t,limit:r,offset:n});return this.getRequest(`shows/${e}/episodes${s}`)}}class ce extends G{async get(e,t){if("string"==typeof e){const r=this.paramsFor({market:t});return this.getRequest(`tracks/${e}${r}`)}const r=this.paramsFor({ids:e,market:t});return(await this.getRequest(`tracks${r}`)).tracks}async audioFeatures(e){if("string"==typeof e)return this.getRequest(`audio-features/${e}`);const t=this.paramsFor({ids:e});return(await this.getRequest(`audio-features${t}`)).audio_features}audioAnalysis(e){return this.getRequest(`audio-analysis/${e}`)}}const ue={access_token:"emptyAccessToken",token_type:"",expires_in:0,refresh_token:"",expires:-1};function le(e){return e===ue}class he extends G{profile(e){return this.getRequest(`users/${e}`)}}class pe extends G{albums;audiobooks;episodes;playlists;shows;tracks;constructor(e){super(e),this.albums=new fe(e),this.audiobooks=new de(e),this.episodes=new ge(e),this.playlists=new ye(e),this.shows=new me(e),this.tracks=new we(e)}profile(){return this.getRequest("me")}topItems(e,t,r,n){const s=this.paramsFor({time_range:t,limit:r,offset:n});return this.getRequest(`me/top/${e}${s}`)}followedArtists(e,t){const r=this.paramsFor({type:"artist",after:e,limit:t});return this.getRequest(`me/following${r}`)}async followArtistsOrUsers(e,t){const r=this.paramsFor({type:t});await this.putRequest(`me/following${r}`,{ids:e})}async unfollowArtistsOrUsers(e,t){const r=this.paramsFor({type:t});await this.deleteRequest(`me/following${r}`,{ids:e})}followsArtistsOrUsers(e,t){const r=this.paramsFor({ids:e,type:t});return this.getRequest(`me/following/contains${r}`)}}class fe extends G{savedAlbums(e,t,r){const n=this.paramsFor({limit:e,offset:t,market:r});return this.getRequest(`me/albums${n}`)}async saveAlbums(e){await this.putRequest("me/albums",e)}async removeSavedAlbums(e){await this.deleteRequest("me/albums",e)}hasSavedAlbums(e){const t=this.paramsFor({ids:e});return this.getRequest(`me/albums/contains${t}`)}}class de extends G{savedAudiobooks(e,t){const r=this.paramsFor({limit:e,offset:t});return this.getRequest(`me/audiobooks${r}`)}async saveAudiobooks(e){await this.putRequest("me/audiobooks",e)}async removeSavedAudiobooks(e){await this.deleteRequest("me/audiobooks",e)}hasSavedAudiobooks(e){const t=this.paramsFor({ids:e});return this.getRequest(`me/audiobooks/contains${t}`)}}class ge extends G{savedEpisodes(e,t,r){const n=this.paramsFor({market:e,limit:t,offset:r});return this.getRequest(`me/episodes${n}`)}async saveEpisodes(e){await this.putRequest("me/episodes",e)}async removeSavedEpisodes(e){await this.deleteRequest("me/episodes",e)}hasSavedEpisodes(e){const t=this.paramsFor({ids:e});return this.getRequest(`me/episodes/contains${t}`)}}class ye extends G{playlists(e,t){const r=this.paramsFor({limit:e,offset:t});return this.getRequest(`me/playlists${r}`)}async follow(e){await this.putRequest(`playlists/${e}/followers`)}async unfollow(e){await this.deleteRequest(`playlists/${e}/followers`)}isFollowing(e,t){const r=this.paramsFor({ids:t});return this.getRequest(`playlists/${e}/followers/contains${r}`)}}class me extends G{savedShows(e,t){const r=this.paramsFor({limit:e,offset:t});return this.getRequest(`me/shows${r}`)}saveShows(e){const t=this.paramsFor({ids:e});return this.putRequest(`me/shows${t}`)}removeSavedShows(e,t){const r=this.paramsFor({ids:e,market:t});return this.deleteRequest(`me/shows${r}`)}hasSavedShow(e){const t=this.paramsFor({ids:e});return this.getRequest(`me/shows/contains${t}`)}}class we extends G{savedTracks(e,t,r){const n=this.paramsFor({limit:e,offset:t,market:r});return this.getRequest(`me/tracks${n}`)}async saveTracks(e){await this.putRequest("me/tracks",e)}async removeSavedTracks(e){await this.deleteRequest("me/tracks",e)}hasSavedTracks(e){const t=this.paramsFor({ids:e});return this.getRequest(`me/tracks/contains${t}`)}}class ve{static get current(){return this.hasSubtleCrypto?window.crypto:this.tryLoadNodeWebCrypto()}static get hasSubtleCrypto(){return"undefined"!=typeof window&&void 0!==window.crypto&&void 0!==window.crypto.subtle}static tryLoadNodeWebCrypto(){try{const{webcrypto:e}=require("crypto");return e}catch(e){throw e}}}class be{static async refreshCachedAccessToken(e,t){const r=await be.refreshToken(e,t.refresh_token);return be.toCachable(r)}static toCachable(e){return e.expires&&-1===e.expires?e:{...e,expires:Date.now()+1e3*e.expires_in}}static async refreshToken(e,t){const r=new URLSearchParams;r.append("client_id",e),r.append("grant_type","refresh_token"),r.append("refresh_token",t);const n=await fetch("https://accounts.spotify.com/api/token",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:r}),s=await n.text();if(!n.ok)throw new Error(`Failed to refresh token: ${n.statusText}, ${s}`);return JSON.parse(s)}static generateCodeVerifier(e){let t="",r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";for(let n=0;n<e;n++)t+=r.charAt(Math.floor(62*Math.random()));return t}static async generateCodeChallenge(e){const t=(new TextEncoder).encode(e),r=await ve.current.subtle.digest("SHA-256",t),n=[...new Uint8Array(r)];return("undefined"!=typeof Buffer?Buffer.from(r).toString("base64"):btoa(String.fromCharCode.apply(null,n))).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}static get crypto(){return this.hasSubtleCrypto?window.crypto:this.tryLoadNodeWebCrypto()}static get hasSubtleCrypto(){return"undefined"!=typeof window&&void 0!==window.crypto&&void 0!==window.crypto.subtle}static tryLoadNodeWebCrypto(){try{const{webcrypto:e}=require("crypto");return e}catch(e){throw e}}}class ke{clientId;clientSecret;scopes;static cacheKey="spotify-sdk:ClientCredentialsStrategy:token";configuration=null;get cache(){return this.configuration.cachingStrategy}constructor(e,t,r=[]){this.clientId=e,this.clientSecret=t,this.scopes=r}setConfiguration(e){this.configuration=e}async getOrCreateAccessToken(){return await this.cache.getOrCreate(ke.cacheKey,(async()=>{const e=await this.getTokenFromApi();return be.toCachable(e)}))}async getAccessToken(){return await this.cache.get(ke.cacheKey)}removeAccessToken(){this.cache.remove(ke.cacheKey)}async getTokenFromApi(){const e={grant_type:"client_credentials",scope:this.scopes.join(" ")},t=Object.keys(e).map((t=>t+"="+e[t])).join("&"),r="undefined"!=typeof Buffer,n=`${this.clientId}:${this.clientSecret}`,s=r?Buffer.from(n).toString("base64"):btoa(n),a=await fetch("https://accounts.spotify.com/api/token",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded",Authorization:`Basic ${s}`},body:t});if(200!==a.status)throw new Error("Failed to get access token.");return await a.json()}}class _e{clientId;redirectUri;scopes;static cacheKey="spotify-sdk:ImplicitGrantStrategy:token";configuration=null;get cache(){return this.configuration.cachingStrategy}constructor(e,t,r){this.clientId=e,this.redirectUri=t,this.scopes=r}setConfiguration(e){this.configuration=e}async getOrCreateAccessToken(){return await this.cache.getOrCreate(_e.cacheKey,(async()=>{const e=await this.redirectOrVerifyToken();return be.toCachable(e)}),(async e=>be.refreshCachedAccessToken(this.clientId,e)))}async getAccessToken(){return await this.cache.get(_e.cacheKey)}removeAccessToken(){this.cache.remove(_e.cacheKey)}async redirectOrVerifyToken(){const e=new URLSearchParams(window.location.hash.substring(1)),t=e.get("access_token");if(t)return Promise.resolve({access_token:t,token_type:e.get("token_type")??"",expires_in:parseInt(e.get("expires_in")??"0"),refresh_token:e.get("refresh_token")??"",expires:Number(e.get("expires"))||0});var r=(this.scopes??[]).join(" ");const n=new URLSearchParams;n.append("client_id",this.clientId),n.append("response_type","token"),n.append("redirect_uri",this.redirectUri),n.append("scope",r);const s="https://accounts.spotify.com/authorize?"+n.toString();return this.configuration.redirectionStrategy.redirect(s),ue}}class $e{clientId;redirectUri;scopes;static cacheKey="spotify-sdk:AuthorizationCodeWithPKCEStrategy:token";configuration=null;get cache(){return this.configuration.cachingStrategy}constructor(e,t,r){this.clientId=e,this.redirectUri=t,this.scopes=r}setConfiguration(e){this.configuration=e}async getOrCreateAccessToken(){return await this.cache.getOrCreate($e.cacheKey,(async()=>{const e=await this.redirectOrVerifyToken();return be.toCachable(e)}),(async e=>be.refreshCachedAccessToken(this.clientId,e)))}async getAccessToken(){return await this.cache.get($e.cacheKey)}removeAccessToken(){this.cache.remove($e.cacheKey)}async redirectOrVerifyToken(){const e=new URLSearchParams(window.location.search).get("code");if(e){const t=await this.verifyAndExchangeCode(e);return this.removeCodeFromUrl(),t}return this.redirectToSpotify(),ue}async redirectToSpotify(){const e=be.generateCodeVerifier(128),t=await be.generateCodeChallenge(e),r={verifier:e,expiresOnAccess:!0};this.cache.setCacheItem("spotify-sdk:verifier",r);const n=await this.generateRedirectUrlForUser(this.scopes,t);await this.configuration.redirectionStrategy.redirect(n)}async verifyAndExchangeCode(e){const t=await this.cache.get("spotify-sdk:verifier"),r=t?.verifier;if(!r)throw new Error("No verifier found in cache - can't validate query string callback parameters.");return await this.configuration.redirectionStrategy.onReturnFromRedirect(),await this.exchangeCodeForToken(e,r)}removeCodeFromUrl(){const e=new URL(window.location.href);e.searchParams.delete("code");const t=e.search?e.href:e.href.replace("?","");window.history.replaceState({},document.title,t)}async generateRedirectUrlForUser(e,t){const r=e.join(" "),n=new URLSearchParams;return n.append("client_id",this.clientId),n.append("response_type","code"),n.append("redirect_uri",this.redirectUri),n.append("scope",r),n.append("code_challenge_method","S256"),n.append("code_challenge",t),`https://accounts.spotify.com/authorize?${n.toString()}`}async exchangeCodeForToken(e,t){const r=new URLSearchParams;r.append("client_id",this.clientId),r.append("grant_type","authorization_code"),r.append("code",e),r.append("redirect_uri",this.redirectUri),r.append("code_verifier",t);const n=await fetch("https://accounts.spotify.com/api/token",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:r}),s=await n.text();if(!n.ok)throw new Error(`Failed to exchange code for token: ${n.statusText}, ${s}`);return JSON.parse(s)}}class xe{async deserialize(e){const t=await e.text();if(t.length>0){return JSON.parse(t)}return null}}class Re{async validateResponse(e){switch(e.status){case 401:throw new Error("Bad or expired token. This can happen if the user revoked a token or the access token has expired. You should re-authenticate the user.");case 403:const t=await e.text();throw new Error(`Bad OAuth request (wrong consumer key, bad nonce, expired timestamp...). Unfortunately, re-authenticating the user won't help here. Body: ${t}`);case 429:throw new Error("The app has exceeded its rate limits.");default:if(!e.status.toString().startsWith("20")){const t=await e.text();throw new Error(`Unrecognised response code: ${e.status} - ${e.statusText}. Body: ${t}`)}}}}class Se{async handleErrors(e){return!1}}class Te{async redirect(e){document.location=e.toString()}async onReturnFromRedirect(){}}class je{storage;updateFunctions;autoRenewInterval;autoRenewWindow;constructor(e,t=new Map,r=0,n=12e4){this.storage=e,this.updateFunctions=t,this.autoRenewInterval=r,this.autoRenewWindow=n,this.autoRenewInterval>0&&setInterval((()=>this.autoRenewRenewableItems()),this.autoRenewInterval)}async getOrCreate(e,t,r){r&&this.updateFunctions.set(e,r);const n=await this.get(e);if(n)return n;const s=await t();if(!s)throw new Error("Could not create cache item");return le(s)||this.setCacheItem(e,s),s}async get(e){let t=this.storage.get(e),r=t?JSON.parse(t):null;if(this.itemDueToExpire(r)&&this.updateFunctions.has(e)){const n=this.updateFunctions.get(e);await this.tryUpdateItem(e,r,n),t=this.storage.get(e),r=t?JSON.parse(t):null}return r?r.expires&&(-1===r.expires||r.expires<=Date.now())?(this.remove(e),null):r.expiresOnAccess&&!0===r.expiresOnAccess?(this.remove(e),r):r:null}set(e,t,r){const n={...t,expires:Date.now()+r};this.setCacheItem(e,n)}setCacheItem(e,t){const r=JSON.stringify(t);this.storage.set(e,r)}remove(e){this.storage.remove(e)}itemDueToExpire(e){return!!e&&(!!e.expires&&e.expires-Date.now()<this.autoRenewWindow)}async autoRenewRenewableItems(){this.updateFunctions.forEach((async(e,t)=>{const r=await this.get(t);r&&e&&this.itemDueToExpire(r)&&await this.tryUpdateItem(t,r,e)}))}async tryUpdateItem(e,t,r){try{const n=await r(t);n&&this.setCacheItem(e,n)}catch(e){console.error(e)}}}class qe extends je{constructor(){super(new Ce)}}class Ce{get(e){return localStorage.getItem(e)}set(e,t){localStorage.setItem(e,t)}remove(e){localStorage.removeItem(e)}}class Ae extends je{constructor(){super(new Oe)}}class Oe{cache=new Map;get(e){return this.cache.get(e)??null}set(e,t){this.cache.set(e,t)}remove(e){this.cache.delete(e)}}class Fe{clientId;accessToken;constructor(e,t){this.clientId=e,this.accessToken=t}setConfiguration(e){}async getOrCreateAccessToken(){if(this.accessToken.expires<=Date.now()){const e=await be.refreshCachedAccessToken(this.clientId,this.accessToken);this.accessToken=e}return this.accessToken}async getAccessToken(){return this.accessToken}removeAccessToken(){this.accessToken={access_token:"",token_type:"",expires_in:0,refresh_token:"",expires:0}}}class ze{sdkConfig;static rootUrl="https://api.spotify.com/v1/";authenticationStrategy;albums;artists;audiobooks;browse;chapters;episodes;recommendations;markets;player;playlists;shows;tracks;users;search;currentUser;constructor(e,t){this.sdkConfig=this.initilizeSdk(t),this.albums=new Q(this),this.artists=new Y(this),this.audiobooks=new X(this),this.browse=new Z(this),this.chapters=new ee(this),this.episodes=new te(this),this.recommendations=new re(this),this.markets=new ne(this),this.player=new se(this),this.playlists=new ae(this),this.shows=new ie(this),this.tracks=new ce(this),this.users=new he(this),this.currentUser=new pe(this);const r=new oe(this);this.search=r.execute.bind(r),this.authenticationStrategy=e,this.authenticationStrategy.setConfiguration(this.sdkConfig)}async makeRequest(e,t,r=void 0,n=void 0){try{const s=await this.authenticationStrategy.getOrCreateAccessToken();if(le(s))return console.warn("No access token found, authenticating now."),null;const a=s?.access_token,o=ze.rootUrl+t,i={method:e,headers:{Authorization:`Bearer ${a}`,"Content-Type":n??"application/json"},body:r?"string"==typeof r?r:JSON.stringify(r):void 0};this.sdkConfig.beforeRequest(o,i);const c=await this.sdkConfig.fetch(o,i);return this.sdkConfig.afterRequest(o,i,c),204===c.status?null:(await this.sdkConfig.responseValidator.validateResponse(c),this.sdkConfig.deserializer.deserialize(c))}catch(e){if(!await this.sdkConfig.errorHandler.handleErrors(e))throw e;return null}}initilizeSdk(e){const t="undefined"!=typeof window,r={fetch:(e,t)=>fetch(e,t),beforeRequest:(e,t)=>{},afterRequest:(e,t,r)=>{},deserializer:new xe,responseValidator:new Re,errorHandler:new Se,redirectionStrategy:new Te,cachingStrategy:t?new qe:new Ae};return{...r,...e}}switchAuthenticationStrategy(e){this.authenticationStrategy=e,this.authenticationStrategy.setConfiguration(this.sdkConfig),this.authenticationStrategy.getOrCreateAccessToken()}async authenticate(){const e=await this.authenticationStrategy.getOrCreateAccessToken();return{authenticated:e.expires>Date.now()&&!le(e),accessToken:e}}async getAccessToken(){return this.authenticationStrategy.getAccessToken()}logOut(){this.authenticationStrategy.removeAccessToken()}static withUserAuthorization(e,t,r=[],n){const s=new $e(e,t,r);return new ze(s,n)}static withClientCredentials(e,t,r=[],n){const s=new ke(e,t,r);return new ze(s,n)}static withImplicitGrant(e,t,r=[],n){const s=new _e(e,t,r);return new ze(s,n)}static withAccessToken(e,t,r){const n=new Fe(e,t);return new ze(n,r)}static async performUserAuthorization(e,t,r,n,s){const a=new $e(e,t,r),o=new ze(a,s),i=await o.authenticationStrategy.getOrCreateAccessToken();JSON.stringify({...i,expires:0})!==JSON.stringify(ue)&&("string"!=typeof n?await n(i):await fetch(n,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)}))}}function Pe(e){return null==e}const Ie="access_token_key_v3",Ee="8f5ffc8e8f4e4ccf8c0c241cf6092d6b",Ue=window.location.host.match("localhost")?`http://${window.location.host}`:`https://${window.location.host}`;async function Ne(e){const t=function(e){let t="";const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";for(let n=0;n<e;n++)t+=r.charAt(Math.floor(Math.random()*r.length));return t}(128),r=await async function(e){const t=(new TextEncoder).encode(e),r=await window.crypto.subtle.digest("SHA-256",t);return btoa(String.fromCharCode.apply(null,[...new Uint8Array(r)])).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}(t);localStorage.setItem("verifier",t);const n=new URLSearchParams;return n.append("client_id",e),n.append("response_type","code"),n.append("redirect_uri",Ue),n.append("scope","user-read-private user-read-email playlist-modify-private playlist-modify-public"),n.append("code_challenge_method","S256"),n.append("code_challenge",r),`https://accounts.spotify.com/authorize?${n.toString()}`}async function Le(){try{const t=localStorage.getItem(Ie);if(console.log(t),!Pe(t)){const r=JSON.parse(t);if(e=r.expiration,!((new Date).getTime()>e))return r.accessToken}}catch(e){console.error("Could not fetch access token from local storage",e)}var e;return null}async function Me(e,t){const r=ze.withAccessToken(Ee,e);return(await r.albums.tracks(t.id)).items}async function Be(e,t,r){const n=ze.withAccessToken(Ee,e);await n.playlists.addItemsToPlaylist(t.id,r.map((e=>e.uri)))}function De(e){const t=[];e:for(let s=0;s<e.length;s++){const a=e[s];if(We(a.name)||Ke(a.name))t.push({selected:!1,track:a});else{for(let o=s+1;o<e.length;o++){const s=e[2];if(r=a.name,!We(n=s.name)&&!Ke(n)&&(r.startsWith(n)||function(e,t){if((e=e.replace(/\s+/g,""))===(t=t.replace(/\s+/g,"")))return 1;if(e.length<2||t.length<2)return 0;const r=new Map;for(let t=0;t<e.length-1;t++){const n=e.substring(t,t+2),s=r.has(n)?r.get(n)+1:1;r.set(n,s)}let n=0;for(let e=0;e<t.length-1;e++){const s=t.substring(e,e+2),a=r.has(s)?r.get(s):0;a>0&&(r.set(s,a-1),n++)}return 2*n/(e.length+t.length-2)}(r,n)>.6)){t.push({selected:!1,track:a});continue e}}t.push({selected:!0,track:a})}}var r,n;return t}function We(e){return void 0!==[/-.*Directo.*/i,/-.*Live.*/i].find((t=>e.match(t)))}function Ke(e){return void 0!==[/-.*Remastered.*/i,/-.*Remaster.*/i].find((t=>e.match(t)))}var Ve="object"==typeof global&&global&&global.Object===Object&&global,Je="object"==typeof self&&self&&self.Object===Object&&self,He=Ve||Je||Function("return this")(),Ge=He.Symbol,Qe=Object.prototype,Ye=Qe.hasOwnProperty,Xe=Qe.toString,Ze=Ge?Ge.toStringTag:void 0;var et=Object.prototype.toString;var tt="[object Null]",rt="[object Undefined]",nt=Ge?Ge.toStringTag:void 0;function st(e){return null==e?void 0===e?rt:tt:nt&&nt in Object(e)?function(e){var t=Ye.call(e,Ze),r=e[Ze];try{e[Ze]=void 0;var n=!0}catch(e){}var s=Xe.call(e);return n&&(t?e[Ze]=r:delete e[Ze]),s}(e):function(e){return et.call(e)}(e)}function at(e){return null!=e&&"object"==typeof e}var ot="[object Symbol]";function it(e){return"symbol"==typeof e||at(e)&&st(e)==ot}function ct(e,t){for(var r=-1,n=null==e?0:e.length,s=Array(n);++r<n;)s[r]=t(e[r],r,e);return s}var ut=Array.isArray,lt=1/0,ht=Ge?Ge.prototype:void 0,pt=ht?ht.toString:void 0;function ft(e){if("string"==typeof e)return e;if(ut(e))return ct(e,ft)+"";if(it(e))return pt?pt.call(e):"";var t=e+"";return"0"==t&&1/e==-lt?"-0":t}var dt=/\s/;var gt=/^\s+/;function yt(e){return e?e.slice(0,function(e){for(var t=e.length;t--&&dt.test(e.charAt(t)););return t}(e)+1).replace(gt,""):e}function mt(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}var wt=NaN,vt=/^[-+]0x[0-9a-f]+$/i,bt=/^0b[01]+$/i,kt=/^0o[0-7]+$/i,_t=parseInt;var $t=1/0,xt=17976931348623157e292;function Rt(e){return e?(e=function(e){if("number"==typeof e)return e;if(it(e))return wt;if(mt(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=mt(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=yt(e);var r=bt.test(e);return r||kt.test(e)?_t(e.slice(2),r?2:8):vt.test(e)?wt:+e}(e))===$t||e===-$t?(e<0?-1:1)*xt:e==e?e:0:0===e?e:0}function St(e){return e}var Tt="[object AsyncFunction]",jt="[object Function]",qt="[object GeneratorFunction]",Ct="[object Proxy]";function At(e){if(!mt(e))return!1;var t=st(e);return t==jt||t==qt||t==Tt||t==Ct}var Ot,Ft=He["__core-js_shared__"],zt=(Ot=/[^.]+$/.exec(Ft&&Ft.keys&&Ft.keys.IE_PROTO||""))?"Symbol(src)_1."+Ot:"";var Pt=Function.prototype.toString;function It(e){if(null!=e){try{return Pt.call(e)}catch(e){}try{return e+""}catch(e){}}return""}var Et=/^\[object .+?Constructor\]$/,Ut=Function.prototype,Nt=Object.prototype,Lt=Ut.toString,Mt=Nt.hasOwnProperty,Bt=RegExp("^"+Lt.call(Mt).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Dt(e){return!(!mt(e)||(t=e,zt&&zt in t))&&(At(e)?Bt:Et).test(It(e));var t}function Wt(e,t){var r=function(e,t){return null==e?void 0:e[t]}(e,t);return Dt(r)?r:void 0}var Kt=Wt(He,"WeakMap"),Vt=9007199254740991,Jt=/^(?:0|[1-9]\d*)$/;function Ht(e,t){var r=typeof e;return!!(t=null==t?Vt:t)&&("number"==r||"symbol"!=r&&Jt.test(e))&&e>-1&&e%1==0&&e<t}function Gt(e,t){return e===t||e!=e&&t!=t}var Qt=9007199254740991;function Yt(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=Qt}function Xt(e){return null!=e&&Yt(e.length)&&!At(e)}var Zt=Object.prototype;function er(e){return at(e)&&"[object Arguments]"==st(e)}var tr=Object.prototype,rr=tr.hasOwnProperty,nr=tr.propertyIsEnumerable,sr=er(function(){return arguments}())?er:function(e){return at(e)&&rr.call(e,"callee")&&!nr.call(e,"callee")},ar=sr;var or="object"==typeof exports&&exports&&!exports.nodeType&&exports,ir=or&&"object"==typeof module&&module&&!module.nodeType&&module,cr=ir&&ir.exports===or?He.Buffer:void 0,ur=(cr?cr.isBuffer:void 0)||function(){return!1},lr={};function hr(e){return function(t){return e(t)}}lr["[object Float32Array]"]=lr["[object Float64Array]"]=lr["[object Int8Array]"]=lr["[object Int16Array]"]=lr["[object Int32Array]"]=lr["[object Uint8Array]"]=lr["[object Uint8ClampedArray]"]=lr["[object Uint16Array]"]=lr["[object Uint32Array]"]=!0,lr["[object Arguments]"]=lr["[object Array]"]=lr["[object ArrayBuffer]"]=lr["[object Boolean]"]=lr["[object DataView]"]=lr["[object Date]"]=lr["[object Error]"]=lr["[object Function]"]=lr["[object Map]"]=lr["[object Number]"]=lr["[object Object]"]=lr["[object RegExp]"]=lr["[object Set]"]=lr["[object String]"]=lr["[object WeakMap]"]=!1;var pr="object"==typeof exports&&exports&&!exports.nodeType&&exports,fr=pr&&"object"==typeof module&&module&&!module.nodeType&&module,dr=fr&&fr.exports===pr&&Ve.process,gr=function(){try{var e=fr&&fr.require&&fr.require("util").types;return e||dr&&dr.binding&&dr.binding("util")}catch(e){}}(),yr=gr&&gr.isTypedArray,mr=yr?hr(yr):function(e){return at(e)&&Yt(e.length)&&!!lr[st(e)]},wr=Object.prototype.hasOwnProperty;function vr(e,t){var r=ut(e),n=!r&&ar(e),s=!r&&!n&&ur(e),a=!r&&!n&&!s&&mr(e),o=r||n||s||a,i=o?function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}(e.length,String):[],c=i.length;for(var u in e)!t&&!wr.call(e,u)||o&&("length"==u||s&&("offset"==u||"parent"==u)||a&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||Ht(u,c))||i.push(u);return i}var br,kr,_r=(br=Object.keys,kr=Object,function(e){return br(kr(e))}),$r=Object.prototype.hasOwnProperty;function xr(e){if(r=(t=e)&&t.constructor,t!==("function"==typeof r&&r.prototype||Zt))return _r(e);var t,r,n=[];for(var s in Object(e))$r.call(e,s)&&"constructor"!=s&&n.push(s);return n}function Rr(e){return Xt(e)?vr(e):xr(e)}var Sr=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Tr=/^\w*$/;function jr(e,t){if(ut(e))return!1;var r=typeof e;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=e&&!it(e))||(Tr.test(e)||!Sr.test(e)||null!=t&&e in Object(t))}var qr=Wt(Object,"create");var Cr=Object.prototype.hasOwnProperty;var Ar=Object.prototype.hasOwnProperty;function Or(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function Fr(e,t){for(var r=e.length;r--;)if(Gt(e[r][0],t))return r;return-1}Or.prototype.clear=function(){this.__data__=qr?qr(null):{},this.size=0},Or.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},Or.prototype.get=function(e){var t=this.__data__;if(qr){var r=t[e];return"__lodash_hash_undefined__"===r?void 0:r}return Cr.call(t,e)?t[e]:void 0},Or.prototype.has=function(e){var t=this.__data__;return qr?void 0!==t[e]:Ar.call(t,e)},Or.prototype.set=function(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=qr&&void 0===t?"__lodash_hash_undefined__":t,this};var zr=Array.prototype.splice;function Pr(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}Pr.prototype.clear=function(){this.__data__=[],this.size=0},Pr.prototype.delete=function(e){var t=this.__data__,r=Fr(t,e);return!(r<0)&&(r==t.length-1?t.pop():zr.call(t,r,1),--this.size,!0)},Pr.prototype.get=function(e){var t=this.__data__,r=Fr(t,e);return r<0?void 0:t[r][1]},Pr.prototype.has=function(e){return Fr(this.__data__,e)>-1},Pr.prototype.set=function(e,t){var r=this.__data__,n=Fr(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this};var Ir=Wt(He,"Map");function Er(e,t){var r,n,s=e.__data__;return("string"==(n=typeof(r=t))||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==r:null===r)?s["string"==typeof t?"string":"hash"]:s.map}function Ur(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}Ur.prototype.clear=function(){this.size=0,this.__data__={hash:new Or,map:new(Ir||Pr),string:new Or}},Ur.prototype.delete=function(e){var t=Er(this,e).delete(e);return this.size-=t?1:0,t},Ur.prototype.get=function(e){return Er(this,e).get(e)},Ur.prototype.has=function(e){return Er(this,e).has(e)},Ur.prototype.set=function(e,t){var r=Er(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this};var Nr="Expected a function";function Lr(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError(Nr);var r=function(){var n=arguments,s=t?t.apply(this,n):n[0],a=r.cache;if(a.has(s))return a.get(s);var o=e.apply(this,n);return r.cache=a.set(s,o)||a,o};return r.cache=new(Lr.Cache||Ur),r}Lr.Cache=Ur;var Mr=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Br=/\\(\\)?/g,Dr=function(e){var t=Lr(e,(function(e){return 500===r.size&&r.clear(),e})),r=t.cache;return t}((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(Mr,(function(e,r,n,s){t.push(n?s.replace(Br,"$1"):r||e)})),t})),Wr=Dr;function Kr(e,t){return ut(e)?e:jr(e,t)?[e]:Wr(function(e){return null==e?"":ft(e)}(e))}var Vr=1/0;function Jr(e){if("string"==typeof e||it(e))return e;var t=e+"";return"0"==t&&1/e==-Vr?"-0":t}function Hr(e,t){for(var r=0,n=(t=Kr(t,e)).length;null!=e&&r<n;)e=e[Jr(t[r++])];return r&&r==n?e:void 0}function Gr(e,t,r){var n=-1,s=e.length;t<0&&(t=-t>s?0:s+t),(r=r>s?s:r)<0&&(r+=s),s=t>r?0:r-t>>>0,t>>>=0;for(var a=Array(s);++n<s;)a[n]=e[n+t];return a}var Qr=Math.ceil,Yr=Math.max;function Xr(e,t,r){t=(r?function(e,t,r){if(!mt(r))return!1;var n=typeof t;return!!("number"==n?Xt(r)&&Ht(t,r.length):"string"==n&&t in r)&&Gt(r[t],e)}(e,t,r):void 0===t)?1:Yr(function(e){var t=Rt(e),r=t%1;return t==t?r?t-r:t:0}(t),0);var n=null==e?0:e.length;if(!n||t<1)return[];for(var s=0,a=0,o=Array(Qr(n/t));s<n;)o[a++]=Gr(e,s,s+=t);return o}function Zr(e){var t=this.__data__=new Pr(e);this.size=t.size}Zr.prototype.clear=function(){this.__data__=new Pr,this.size=0},Zr.prototype.delete=function(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r},Zr.prototype.get=function(e){return this.__data__.get(e)},Zr.prototype.has=function(e){return this.__data__.has(e)},Zr.prototype.set=function(e,t){var r=this.__data__;if(r instanceof Pr){var n=r.__data__;if(!Ir||n.length<199)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new Ur(n)}return r.set(e,t),this.size=r.size,this};var en=Object.prototype.propertyIsEnumerable,tn=Object.getOwnPropertySymbols,rn=tn?function(e){return null==e?[]:(e=Object(e),function(e,t){for(var r=-1,n=null==e?0:e.length,s=0,a=[];++r<n;){var o=e[r];t(o,r,e)&&(a[s++]=o)}return a}(tn(e),(function(t){return en.call(e,t)})))}:function(){return[]};function nn(e){return function(e,t,r){var n=t(e);return ut(e)?n:function(e,t){for(var r=-1,n=t.length,s=e.length;++r<n;)e[s+r]=t[r];return e}(n,r(e))}(e,Rr,rn)}var sn=Wt(He,"DataView"),an=Wt(He,"Promise"),on=Wt(He,"Set"),cn="[object Map]",un="[object Promise]",ln="[object Set]",hn="[object WeakMap]",pn="[object DataView]",fn=It(sn),dn=It(Ir),gn=It(an),yn=It(on),mn=It(Kt),wn=st;(sn&&wn(new sn(new ArrayBuffer(1)))!=pn||Ir&&wn(new Ir)!=cn||an&&wn(an.resolve())!=un||on&&wn(new on)!=ln||Kt&&wn(new Kt)!=hn)&&(wn=function(e){var t=st(e),r="[object Object]"==t?e.constructor:void 0,n=r?It(r):"";if(n)switch(n){case fn:return pn;case dn:return cn;case gn:return un;case yn:return ln;case mn:return hn}return t});var vn=wn,bn=He.Uint8Array;function kn(e){var t=-1,r=null==e?0:e.length;for(this.__data__=new Ur;++t<r;)this.add(e[t])}function _n(e,t){for(var r=-1,n=null==e?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1}kn.prototype.add=kn.prototype.push=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},kn.prototype.has=function(e){return this.__data__.has(e)};var $n=1,xn=2;function Rn(e,t,r,n,s,a){var o=r&$n,i=e.length,c=t.length;if(i!=c&&!(o&&c>i))return!1;var u=a.get(e),l=a.get(t);if(u&&l)return u==t&&l==e;var h=-1,p=!0,f=r&xn?new kn:void 0;for(a.set(e,t),a.set(t,e);++h<i;){var d=e[h],g=t[h];if(n)var y=o?n(g,d,h,t,e,a):n(d,g,h,e,t,a);if(void 0!==y){if(y)continue;p=!1;break}if(f){if(!_n(t,(function(e,t){if(o=t,!f.has(o)&&(d===e||s(d,e,r,n,a)))return f.push(t);var o}))){p=!1;break}}else if(d!==g&&!s(d,g,r,n,a)){p=!1;break}}return a.delete(e),a.delete(t),p}function Sn(e){var t=-1,r=Array(e.size);return e.forEach((function(e,n){r[++t]=[n,e]})),r}function Tn(e){var t=-1,r=Array(e.size);return e.forEach((function(e){r[++t]=e})),r}var jn=1,qn=2,Cn="[object Boolean]",An="[object Date]",On="[object Error]",Fn="[object Map]",zn="[object Number]",Pn="[object RegExp]",In="[object Set]",En="[object String]",Un="[object Symbol]",Nn="[object ArrayBuffer]",Ln="[object DataView]",Mn=Ge?Ge.prototype:void 0,Bn=Mn?Mn.valueOf:void 0;var Dn=1,Wn=Object.prototype.hasOwnProperty;var Kn=1,Vn="[object Arguments]",Jn="[object Array]",Hn="[object Object]",Gn=Object.prototype.hasOwnProperty;function Qn(e,t,r,n,s,a){var o=ut(e),i=ut(t),c=o?Jn:vn(e),u=i?Jn:vn(t),l=(c=c==Vn?Hn:c)==Hn,h=(u=u==Vn?Hn:u)==Hn,p=c==u;if(p&&ur(e)){if(!ur(t))return!1;o=!0,l=!1}if(p&&!l)return a||(a=new Zr),o||mr(e)?Rn(e,t,r,n,s,a):function(e,t,r,n,s,a,o){switch(r){case Ln:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case Nn:return!(e.byteLength!=t.byteLength||!a(new bn(e),new bn(t)));case Cn:case An:case zn:return Gt(+e,+t);case On:return e.name==t.name&&e.message==t.message;case Pn:case En:return e==t+"";case Fn:var i=Sn;case In:var c=n&jn;if(i||(i=Tn),e.size!=t.size&&!c)return!1;var u=o.get(e);if(u)return u==t;n|=qn,o.set(e,t);var l=Rn(i(e),i(t),n,s,a,o);return o.delete(e),l;case Un:if(Bn)return Bn.call(e)==Bn.call(t)}return!1}(e,t,c,r,n,s,a);if(!(r&Kn)){var f=l&&Gn.call(e,"__wrapped__"),d=h&&Gn.call(t,"__wrapped__");if(f||d){var g=f?e.value():e,y=d?t.value():t;return a||(a=new Zr),s(g,y,r,n,a)}}return!!p&&(a||(a=new Zr),function(e,t,r,n,s,a){var o=r&Dn,i=nn(e),c=i.length;if(c!=nn(t).length&&!o)return!1;for(var u=c;u--;){var l=i[u];if(!(o?l in t:Wn.call(t,l)))return!1}var h=a.get(e),p=a.get(t);if(h&&p)return h==t&&p==e;var f=!0;a.set(e,t),a.set(t,e);for(var d=o;++u<c;){var g=e[l=i[u]],y=t[l];if(n)var m=o?n(y,g,l,t,e,a):n(g,y,l,e,t,a);if(!(void 0===m?g===y||s(g,y,r,n,a):m)){f=!1;break}d||(d="constructor"==l)}if(f&&!d){var w=e.constructor,v=t.constructor;w==v||!("constructor"in e)||!("constructor"in t)||"function"==typeof w&&w instanceof w&&"function"==typeof v&&v instanceof v||(f=!1)}return a.delete(e),a.delete(t),f}(e,t,r,n,s,a))}function Yn(e,t,r,n,s){return e===t||(null==e||null==t||!at(e)&&!at(t)?e!=e&&t!=t:Qn(e,t,r,n,Yn,s))}var Xn=1,Zn=2;function es(e){return e==e&&!mt(e)}function ts(e,t){return function(r){return null!=r&&(r[e]===t&&(void 0!==t||e in Object(r)))}}function rs(e){var t=function(e){for(var t=Rr(e),r=t.length;r--;){var n=t[r],s=e[n];t[r]=[n,s,es(s)]}return t}(e);return 1==t.length&&t[0][2]?ts(t[0][0],t[0][1]):function(r){return r===e||function(e,t,r,n){var s=r.length,a=s,o=!n;if(null==e)return!a;for(e=Object(e);s--;){var i=r[s];if(o&&i[2]?i[1]!==e[i[0]]:!(i[0]in e))return!1}for(;++s<a;){var c=(i=r[s])[0],u=e[c],l=i[1];if(o&&i[2]){if(void 0===u&&!(c in e))return!1}else{var h=new Zr;if(n)var p=n(u,l,c,e,t,h);if(!(void 0===p?Yn(l,u,Xn|Zn,n,h):p))return!1}}return!0}(r,e,t)}}function ns(e,t){return null!=e&&t in Object(e)}function ss(e,t){return null!=e&&function(e,t,r){for(var n=-1,s=(t=Kr(t,e)).length,a=!1;++n<s;){var o=Jr(t[n]);if(!(a=null!=e&&r(e,o)))break;e=e[o]}return a||++n!=s?a:!!(s=null==e?0:e.length)&&Yt(s)&&Ht(o,s)&&(ut(e)||ar(e))}(e,t,ns)}var as=1,os=2;function is(e,t){return jr(e)&&es(t)?ts(Jr(e),t):function(r){var n=function(e,t,r){var n=null==e?void 0:Hr(e,t);return void 0===n?r:n}(r,e);return void 0===n&&n===t?ss(r,e):Yn(t,n,as|os)}}function cs(e){return jr(e)?(t=Jr(e),function(e){return null==e?void 0:e[t]}):function(e){return function(t){return Hr(t,e)}}(e);var t}function us(e){return"function"==typeof e?e:null==e?St:"object"==typeof e?ut(e)?is(e[0],e[1]):rs(e):cs(e)}function ls(e,t,r,n){for(var s=-1,a=null==e?0:e.length;++s<a;){var o=e[s];t(n,o,r(o),e)}return n}var hs,ps=function(e,t,r){for(var n=-1,s=Object(e),a=r(e),o=a.length;o--;){var i=a[hs?o:++n];if(!1===t(s[i],i,s))break}return e};var fs=function(e,t){return function(r,n){if(null==r)return r;if(!Xt(r))return e(r,n);for(var s=r.length,a=t?s:-1,o=Object(r);(t?a--:++a<s)&&!1!==n(o[a],a,o););return r}}((function(e,t){return e&&ps(e,t,Rr)})),ds=fs;function gs(e,t,r,n){return ds(e,(function(e,s,a){t(n,e,r(e),a)})),n}function ys(e,t){if(e!==t){var r=void 0!==e,n=null===e,s=e==e,a=it(e),o=void 0!==t,i=null===t,c=t==t,u=it(t);if(!i&&!u&&!a&&e>t||a&&o&&c&&!i&&!u||n&&o&&c||!r&&c||!s)return 1;if(!n&&!a&&!u&&e<t||u&&r&&s&&!n&&!a||i&&r&&s||!o&&s||!c)return-1}return 0}function ms(e,t,r){t=t.length?ct(t,(function(e){return ut(e)?function(t){return Hr(t,1===e.length?e[0]:e)}:e})):[St];var n=-1;t=ct(t,hr(us));var s=function(e,t){var r=-1,n=Xt(e)?Array(e.length):[];return ds(e,(function(e,s,a){n[++r]=t(e,s,a)})),n}(e,(function(e,r,s){return{criteria:ct(t,(function(t){return t(e)})),index:++n,value:e}}));return function(e,t){var r=e.length;for(e.sort(t);r--;)e[r]=e[r].value;return e}(s,(function(e,t){return function(e,t,r){for(var n=-1,s=e.criteria,a=t.criteria,o=s.length,i=r.length;++n<o;){var c=ys(s[n],a[n]);if(c)return n>=i?c:c*("desc"==r[n]?-1:1)}return e.index-t.index}(e,t,r)}))}var ws,vs,bs=(ws=function(e,t,r){e[r?0:1].push(t)},vs=function(){return[[],[]]},function(e,t){var r=ut(e)?ls:gs,n=vs?vs():{};return r(e,ws,us(t),n)}),ks=bs;function _s(e,t){void 0===t&&(t={});var r=t.insertAt;if(e&&"undefined"!=typeof document){var n=document.head||document.getElementsByTagName("head")[0],s=document.createElement("style");s.type="text/css","top"===r&&n.firstChild?n.insertBefore(s,n.firstChild):n.appendChild(s),s.styleSheet?s.styleSheet.cssText=e:s.appendChild(document.createTextNode(e))}}function $s(e,t,r){const n=e.slice();return n[17]=t[r],n}function xs(e){let t,r,s,a,o,i,c,f,g,w,k,_,$,x=[],R=new Map,S=!Pe(e[6]),T=N(e[1]);const j=e=>e[17].id;for(let t=0;t<T.length;t+=1){let r=$s(e,T,t),n=j(r);R.set(n,x[t]=Ts(n,r))}let q=e[5]&&js(e),C=S&&qs(e),A=e[8]&&Cs();return{c(){t=p("div");for(let e=0;e<x.length;e+=1)x[e].c();r=d(),s=p("div"),a=p("p"),a.textContent="Playlist Name",o=d(),i=p("input"),c=d(),f=p("button"),f.textContent="Generate",g=d(),q&&q.c(),w=d(),C&&C.c(),k=d(),A&&A.c(),m(t,"class","album-container svelte-k3kuez"),b(a,"font-weight","bold"),m(i,"type","text"),m(f,"class","generate-playlist svelte-k3kuez")},m(n,h){l(n,t,h);for(let e=0;e<x.length;e+=1)x[e]&&x[e].m(t,null);l(n,r,h),l(n,s,h),u(s,a),u(s,o),u(s,i),v(i,e[0]),u(s,c),u(s,f),u(s,g),q&&q.m(s,null),u(s,w),C&&C.m(s,null),u(s,k),A&&A.m(s,null),_||($=[y(i,"input",e[15]),y(f,"click",e[10])],_=!0)},p(e,r){530&r&&(T=N(e[1]),x=B(x,r,j,1,e,T,R,t,L,Ts,null,$s)),1&r&&i.value!==e[0]&&v(i,e[0]),e[5]?q?q.p(e,r):(q=js(e),q.c(),q.m(s,w)):q&&(q.d(1),q=null),64&r&&(S=!Pe(e[6])),S?C?C.p(e,r):(C=qs(e),C.c(),C.m(s,k)):C&&(C.d(1),C=null),e[8]?A||(A=Cs(),A.c(),A.m(s,null)):A&&(A.d(1),A=null)},d(e){e&&(h(t),h(r),h(s));for(let e=0;e<x.length;e+=1)x[e].d();q&&q.d(),C&&C.d(),A&&A.d(),_=!1,n($)}}}function Rs(e){let t,r;return{c(){t=p("p"),r=f(e[3]),m(t,"class","error-message svelte-k3kuez")},m(e,n){l(e,t,n),u(t,r)},p(e,t){8&t&&w(r,e[3])},d(e){e&&h(t)}}}function Ss(t){let r;return{c(){r=p("div"),m(r,"class","loader svelte-k3kuez")},m(e,t){l(e,r,t)},p:e,d(e){e&&h(r)}}}function Ts(e,t){let r,n,s,a,o,i,c,g=t[17].name+"";function v(){return t[14](t[17])}return{key:e,first:null,c(){r=p("div"),n=p("p"),s=f(g),a=d(),m(n,"class","album-title svelte-k3kuez"),m(r,"class",o="album "+(t[4][t[17].id]?"":"album--selected")+" svelte-k3kuez"),this.first=r},m(e,t){l(e,r,t),u(r,n),u(n,s),u(r,a),i||(c=y(r,"click",v),i=!0)},p(e,n){t=e,2&n&&g!==(g=t[17].name+"")&&w(s,g),18&n&&o!==(o="album "+(t[4][t[17].id]?"":"album--selected")+" svelte-k3kuez")&&m(r,"class",o)},d(e){e&&h(r),i=!1,c()}}}function js(e){let t,r=(100*e[7]).toFixed(0)+"%";return{c(){t=f(r)},m(e,r){l(e,t,r)},p(e,n){128&n&&r!==(r=(100*e[7]).toFixed(0)+"%")&&w(t,r)},d(e){e&&h(t)}}}function qs(e){let t,r;return{c(){t=p("p"),r=f(e[6]),m(t,"class","error-message svelte-k3kuez")},m(e,n){l(e,t,n),u(t,r)},p(e,t){64&t&&w(r,e[6])},d(e){e&&h(t)}}}function Cs(e){let t;return{c(){t=p("p"),t.textContent="Success",m(t,"class","success-message svelte-k3kuez")},m(e,r){l(e,t,r)},d(e){e&&h(t)}}}function As(t){let r,n;function s(e,t){return 8&t&&(r=null),e[2]?Ss:(null==r&&(r=!Pe(e[3])),r?Rs:xs)}let a=s(t,-1),o=a(t);return{c(){o.c(),n=g()},m(e,t){o.m(e,t),l(e,n,t)},p(e,[t]){a===(a=s(e,t))&&o?o.p(e,t):(o.d(1),o=a(e),o&&(o.c(),o.m(n.parentNode,n)))},i:e,o:e,d(e){e&&h(n),o.d(e)}}}function Os(e,t,r){let n,s,a,o,i,c,u,l,{profile:h}=t,{artist:p}=t,{accessToken:f}=t,d=p.name;function g(e){r(4,o[e]=!o[e],o)}!async function(){try{r(1,n=await async function(e,t){const r=ze.withAccessToken(Ee,e);return(await r.artists.albums(t.id,["album","single"].join(","))).items}(f,p))}catch(e){r(3,a=e.message)}finally{r(2,s=!1)}}();return e.$$set=e=>{"profile"in e&&r(11,h=e.profile),"artist"in e&&r(12,p=e.artist),"accessToken"in e&&r(13,f=e.accessToken)},r(1,n=[]),r(3,a=null),r(2,s=!0),r(4,o={}),r(5,i=!1),r(6,c=null),r(7,u=0),r(8,l=!1),[d,n,s,a,o,i,c,u,l,g,async function(){const e=[];try{r(5,i=!0),r(7,u=0);const c=(s="release_date",a="desc",null==(t=n)?[]:(ut(s)||(s=null==s?[]:[s]),ut(a=p?void 0:a)||(a=null==a?[]:[a]),ms(t,s,a)));for(const t of c){if(o[t.id]){r(7,u+=1/n.length);continue}console.log("selected",t);const s=await Me(f,t);e.push(...s)}const[g,y]=ks(De(e),"selected");r(7,u=0);const m=Xr(g,100),w=await async function(e,t,r){const n=ze.withAccessToken(Ee,e);return await n.playlists.createPlaylist(t,{name:r,public:!1})}(f,h.id,d);console.log("nonselected",y),console.log("selected",g);for(const e of m)console.log(e),await Be(f,w,e.map((e=>e.track))),r(7,u+=1/m.length);r(8,l=!0)}catch(e){r(6,c=e.message)}finally{r(5,i=!1)}var t,s,a,p},h,p,f,e=>{g(e.id)},function(){d=this.value,r(0,d)}]}_s(".loader.svelte-k3kuez{border:4px solid #f3f3f3;border-top:4px solid #3498db;border-radius:50%;width:15px;height:15px;animation:svelte-k3kuez-spin 2s linear infinite}@keyframes svelte-k3kuez-spin{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}.error-message.svelte-k3kuez{color:darkred}.album-container.svelte-k3kuez{display:flex;flex-direction:row;flex-wrap:wrap;padding:4px}.album.svelte-k3kuez{flex-grow:1;flex-basis:calc(20% - 8px) ;display:flex;margin:2px;padding:2px 2px 2px 2px;background:lightgrey;border-radius:2px;border:1px groove dimgray;height:40px;text-align:center;justify-content:center}.album.svelte-k3kuez:hover{transform:scale(1.01, 1.01)}.album--selected.svelte-k3kuez{border:2px groove dimgray}.album-title.svelte-k3kuez{align-self:center;font-size:0.8rem;overflow:hidden;line-height:1rem;max-height:2rem;-webkit-box-orient:vertical;display:block;display:-webkit-box;text-overflow:ellipsis;-webkit-line-clamp:2;margin:0px;user-select:none}.generate-playlist.svelte-k3kuez{background:dodgerblue;color:white;border-radius:2px;border:2px groove dodgerblue}.generate-playlist.svelte-k3kuez:hover{transform:scale(1.01, 1.01)}.success-message.svelte-k3kuez{color:green;font-weight:bold}");class Fs extends H{constructor(e){super(),J(this,e,Os,As,a,{profile:11,artist:12,accessToken:13})}}function zs(e){let t,r,n;return{c(){t=p("img"),m(t,"height","40px"),m(t,"width","40px"),c(t.src,r=e[0].images[0].url)||m(t,"src",r),m(t,"alt",n=e[0].name+"-image")},m(e,r){l(e,t,r)},p(e,s){1&s&&!c(t.src,r=e[0].images[0].url)&&m(t,"src",r),1&s&&n!==(n=e[0].name+"-image")&&m(t,"alt",n)},d(e){e&&h(t)}}}function Ps(e){let t,r,n;return r=new Fs({props:{profile:e[1],artist:e[0],accessToken:e[2]}}),{c(){t=p("div"),D(r.$$.fragment),b(t,"margin","4px")},m(e,s){l(e,t,s),W(r,t,null),n=!0},p(e,t){const n={};2&t&&(n.profile=e[1]),1&t&&(n.artist=e[0]),4&t&&(n.accessToken=e[2]),r.$set(n)},i(e){n||(E(r.$$.fragment,e),n=!0)},o(e){U(r.$$.fragment,e),n=!1},d(e){e&&h(t),K(r)}}}function Is(e){let t,r,n,s,a,o,i,c,v,b=e[0].name+"",k=e[0].images.length>0&&zs(e),_=e[3]&&Ps(e);return{c(){t=p("div"),k&&k.c(),r=d(),n=p("p"),s=f(b),a=d(),_&&_.c(),o=g(),m(n,"class","artist-title svelte-mzontl"),m(t,"class","artist-container svelte-mzontl")},m(h,p){l(h,t,p),k&&k.m(t,null),u(t,r),u(t,n),u(n,s),l(h,a,p),_&&_.m(h,p),l(h,o,p),i=!0,c||(v=y(t,"click",e[4]),c=!0)},p(e,[n]){e[0].images.length>0?k?k.p(e,n):(k=zs(e),k.c(),k.m(t,r)):k&&(k.d(1),k=null),(!i||1&n)&&b!==(b=e[0].name+"")&&w(s,b),e[3]?_?(_.p(e,n),8&n&&E(_,1)):(_=Ps(e),_.c(),E(_,1),_.m(o.parentNode,o)):_&&(P(),U(_,1,1,(()=>{_=null})),I())},i(e){i||(E(_),i=!0)},o(e){U(_),i=!1},d(e){e&&(h(t),h(a),h(o)),k&&k.d(),_&&_.d(e),c=!1,v()}}}function Es(e,t,r){let{artist:n}=t,{profile:s}=t,{accessToken:a}=t,o=!1;return e.$$set=e=>{"artist"in e&&r(0,n=e.artist),"profile"in e&&r(1,s=e.profile),"accessToken"in e&&r(2,a=e.accessToken)},[n,s,a,o,function(){r(3,o=!o)}]}_s(".artist-container.svelte-mzontl{display:flex;flex-direction:row;align-items:center;margin:4px;padding:2px 2px 2px 10px;background:lightgreen;border-radius:4px;border:2px groove darkgreen}.artist-container.svelte-mzontl:hover{transform:scale(1.01, 1.01)}.artist-title.svelte-mzontl{font-weight:bold;margin-left:3px}");class Us extends H{constructor(e){super(),J(this,e,Es,Is,a,{artist:0,profile:1,accessToken:2})}}function Ns(e,t,r){const n=e.slice();return n[5]=t[r],n}function Ls(e,t){let r,n,s,a;return n=new Us({props:{profile:t[0],artist:t[5],accessToken:t[1]}}),{key:e,first:null,c(){r=p("li"),D(n.$$.fragment),s=d(),this.first=r},m(e,t){l(e,r,t),W(n,r,null),u(r,s),a=!0},p(e,r){t=e;const s={};1&r&&(s.profile=t[0]),8&r&&(s.artist=t[5]),2&r&&(s.accessToken=t[1]),n.$set(s)},i(e){a||(E(n.$$.fragment,e),a=!0)},o(e){U(n.$$.fragment,e),a=!1},d(e){e&&h(r),K(n)}}}function Ms(e){let t,r,n,s,a,o,i,c,g,v,k=[],_=new Map,$=N(e[3].slice(0,10));const x=e=>e[5].id;for(let t=0;t<$.length;t+=1){let r=Ns(e,$,t),n=x(r);_.set(n,k[t]=Ls(n,r))}return{c(){t=p("p"),r=f("Welcome "),n=f(e[2]),s=d(),a=p("input"),o=d(),i=p("ul");for(let e=0;e<k.length;e+=1)k[e].c();m(a,"type","text"),m(a,"placeholder","e.g. Eagles..."),b(i,"list-style-type","none"),b(i,"padding-left","0")},m(h,p){l(h,t,p),u(t,r),u(t,n),l(h,s,p),l(h,a,p),l(h,o,p),l(h,i,p);for(let e=0;e<k.length;e+=1)k[e]&&k[e].m(i,null);c=!0,g||(v=y(a,"input",e[4]),g=!0)},p(e,[t]){(!c||4&t)&&w(n,e[2]),11&t&&($=N(e[3].slice(0,10)),P(),k=B(k,t,x,1,e,$,_,i,M,Ls,null,Ns),I())},i(e){if(!c){for(let e=0;e<$.length;e+=1)E(k[e]);c=!0}},o(e){for(let e=0;e<k.length;e+=1)U(k[e]);c=!1},d(e){e&&(h(t),h(s),h(a),h(o),h(i));for(let e=0;e<k.length;e+=1)k[e].d();g=!1,v()}}}function Bs(e,t,r){let n,s,{profile:a}=t,{token:o}=t;const i=function(e,t){let r;return function(...n){clearTimeout(r),r=setTimeout((()=>{e(...n)}),t)}}((async function(e){const t=e.target.value;console.log(t),""!==t&&r(3,({items:s}=await async function(e,t){const r=ze.withAccessToken(Ee,e),{artists:n}=await r.search(t,["artist"]);return console.log(n),n}(o,t)),s)}),100);return e.$$set=e=>{"profile"in e&&r(0,a=e.profile),"token"in e&&r(1,o=e.token)},e.$$.update=()=>{1&e.$$.dirty&&r(2,n=a.display_name)},r(3,s=[]),[a,o,n,s,i]}class Ds extends H{constructor(e){super(),J(this,e,Bs,Ms,a,{profile:0,token:1})}}function Ws(e){let t,r;return t=new Ds({props:{profile:e[0],token:e[1]}}),{c(){D(t.$$.fragment)},m(e,n){W(t,e,n),r=!0},p(e,r){const n={};1&r&&(n.profile=e[0]),2&r&&(n.token=e[1]),t.$set(n)},i(e){r||(E(t.$$.fragment,e),r=!0)},o(e){U(t.$$.fragment,e),r=!1},d(e){K(t,e)}}}function Ks(t){let r;return{c(){r=p("h"),r.textContent="Login"},m(e,t){l(e,r,t)},p:e,i:e,o:e,d(e){e&&h(r)}}}function Vs(e){let t,r,n,s;const a=[Ks,Ws],o=[];function i(e,t){return null===e[0]?0:1}return t=i(e),r=o[t]=a[t](e),{c(){r.c(),n=g()},m(e,r){o[t].m(e,r),l(e,n,r),s=!0},p(e,[s]){let c=t;t=i(e),t===c?o[t].p(e,s):(P(),U(o[c],1,1,(()=>{o[c]=null})),I(),r=o[t],r?r.p(e,s):(r=o[t]=a[t](e),r.c()),E(r,1),r.m(n.parentNode,n))},i(e){s||(E(r),s=!0)},o(e){U(r),s=!1},d(e){e&&h(n),o[t].d(e)}}}function Js(e,t,r){let n,s=null;async function a(){const e=await Ne(Ee);document.location=e}return async function(){const e=new URLSearchParams(window.location.search).get("code");if(console.log("code",e),Pe(e)){if(r(1,n=await Le()),Pe(n))return void await a()}else try{r(1,n=await async function(e,t){const r=localStorage.getItem("verifier"),n=new URLSearchParams;n.append("client_id",e),n.append("grant_type","authorization_code"),n.append("code",t),n.append("redirect_uri",Ue),n.append("code_verifier",r);const s=await fetch("https://accounts.spotify.com/api/token?",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:n}),a=await s.json(),{access_token:o}=a;if(Pe(o))throw new Error(a.error);const i={expiration:(c=a.expires_in,(new Date).getTime()+1e3*c),accessToken:a};var c;return localStorage.setItem(Ie,JSON.stringify(i)),a}(Ee,e))}catch(e){return void await a()}r(0,s=await async function(e){const t=await fetch("https://api.spotify.com/v1/me",{method:"GET",headers:{Authorization:`Bearer ${e.access_token}`}});return await t.json()}(n)),console.log(s)}(),[s,n]}_s("body{font-family:'SansSerif', sans-serif;font-size:13px}");return new class extends H{constructor(e){super(),J(this,e,Js,Vs,a,{})}}({target:document.body,props:{name:"playlister"}})}();
